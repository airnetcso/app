<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Latihan Membaca Korea</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#f4f6fb;
}
.container{
  padding:20px;
}
h2{
  text-align:center;
  margin-bottom:10px;
}

.text-box{
  background:#fff;
  padding:24px;
  border-radius:20px;
  font-size:26px;
  line-height:1.8;
  text-align:center;
  margin-bottom:12px;
}

.ok{color:#1db954;font-weight:800}
.bad{color:#ff4d4d;font-weight:800}
.wait{color:#999}

.status{
  text-align:center;
  font-size:14px;
  min-height:22px;
  margin-bottom:10px;
}

button{
  width:100%;
  padding:15px;
  margin-top:8px;
  font-size:16px;
  border-radius:16px;
  border:none;
  background:#4f8cff;
  color:#fff;
  font-weight:700;
}
</style>
</head>

<body>

<div class="container">
  <h2>Latihan Membaca Korea</h2>

  <div class="text-box" id="textBox"></div>
  <div class="status" id="status">ğŸ™ï¸ Tekan mulai dan baca sampai selesai</div>

  <button id="startBtn" onclick="start()">â–¶ Mulai</button>
  <button id="repeatBtn" onclick="reset()" style="display:none">ğŸ” Ulangi</button>
</div>

<script>
// ================== DATA LATIHAN ==================
const kalimat =
"ì €ëŠ” í•œêµ­ì–´ë¥¼ ê³µë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤ ê°ì‚¬í•©ë‹ˆë‹¤";

// pecah per kata
const kataTarget = kalimat.split(" ");

// ================== STATE ==================
let idx = 0;
let rec;
let spokenWords = [];

// ================== RENDER ==================
function render(state="wait"){
  let html="";
  kataTarget.forEach((k,i)=>{
    if(i < idx) html += `<span class="ok">${k} </span>`;
    else if(i === idx && state === "bad") html += `<span class="bad">${k} </span>`;
    else html += `<span class="wait">${k} </span>`;
  });
  textBox.innerHTML = html;
}
render();

// ================== START ==================
function start(){
  idx = 0;
  spokenWords = [];
  render();
  status.textContent = "ğŸ™ï¸ Mendengarkan...";
  startBtn.style.display = "none";
  repeatBtn.style.display = "none";
  startRec();
}

// ================== SPEECH ==================
function startRec(){
  if(!('webkitSpeechRecognition' in window)){
    alert("Browser tidak mendukung speech recognition");
    return;
  }

  rec = new webkitSpeechRecognition();
  rec.lang = "ko-KR";
  rec.continuous = true;
  rec.interimResults = true;

  rec.onresult = e => {
    const text = e.results[e.results.length-1][0].transcript.trim();
    if(!text) return;

    // pecah semua kata yang terdengar
    const words = text.split(/\s+/);

    // proses kata satu per satu
    while(words.length && idx < kataTarget.length){
      const w = words.shift();
      const target = kataTarget[idx];

      if(w === target){
        idx++;
        render();
        status.textContent = `âœ”ï¸ Benar: ${w}`;
      }else{
        render("bad");
        status.textContent = `âŒ Salah: ${target}`;
        break;
      }
    }

    // selesai semua
    if(idx >= kataTarget.length){
      status.textContent = "ğŸ‰ Selesai! Bacaan bagus!";
      rec.stop();
      repeatBtn.style.display = "block";
    }
  };

  rec.start();
}

// ================== RESET ==================
function reset(){
  idx = 0;
  render();
  status.textContent = "ğŸ™ï¸ Tekan mulai dan baca sampai selesai";
  startBtn.style.display = "block";
  repeatBtn.style.display = "none";
}
</script>

</body>
</html>
